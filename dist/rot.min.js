var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(c,h,m){c!=Array.prototype&&c!=Object.prototype&&(c[h]=m.value)};$jscomp.getGlobal=function(c){return"undefined"!=typeof window&&window===c?c:"undefined"!=typeof global&&null!=global?global:c};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(c,h,m,q){if(h){m=$jscomp.global;c=c.split(".");for(q=0;q<c.length-1;q++){var t=c[q];t in m||(m[t]={});m=m[t]}c=c[c.length-1];q=m[c];h=h(q);h!=q&&null!=h&&$jscomp.defineProperty(m,c,{configurable:!0,writable:!0,value:h})}};$jscomp.underscoreProtoCanBeSet=function(){var c={a:!0},h={};try{return h.__proto__=c,h.a}catch(m){}return!1};
$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(c,h){c.__proto__=h;if(c.__proto__!==h)throw new TypeError(c+" is not extensible");return c}:null;$jscomp.polyfill("Object.setPrototypeOf",function(c){return c||$jscomp.setPrototypeOf},"es6","es5");
$jscomp.polyfill("Array.prototype.fill",function(c){return c?c:function(c,m,q){var h=this.length||0;0>m&&(m=Math.max(0,h+m));if(null==q||q>h)q=h;q=Number(q);0>q&&(q=Math.max(0,h+q));for(m=Number(m||0);m<q;m++)this[m]=c;return this}},"es6","es3");$jscomp.owns=function(c,h){return Object.prototype.hasOwnProperty.call(c,h)};$jscomp.assign="function"==typeof Object.assign?Object.assign:function(c,h){for(var m=1;m<arguments.length;m++){var q=arguments[m];if(q)for(var t in q)$jscomp.owns(q,t)&&(c[t]=q[t])}return c};
$jscomp.polyfill("Object.assign",function(c){return c||$jscomp.assign},"es6","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var c=0;return function(h){return $jscomp.SYMBOL_PREFIX+(h||"")+c++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var c=$jscomp.global.Symbol.iterator;c||(c=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[c]&&$jscomp.defineProperty(Array.prototype,c,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var c=$jscomp.global.Symbol.asyncIterator;c||(c=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.arrayIterator=function(c){var h=0;return $jscomp.iteratorPrototype(function(){return h<c.length?{done:!1,value:c[h++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(c){$jscomp.initSymbolIterator();c={next:c};c[$jscomp.global.Symbol.iterator]=function(){return this};return c};$jscomp.iteratorFromArray=function(c,h){$jscomp.initSymbolIterator();c instanceof String&&(c+="");var m=0,q={next:function(){if(m<c.length){var t=m++;return{value:h(t,c[t]),done:!1}}q.next=function(){return{done:!0,value:void 0}};return q.next()}};q[Symbol.iterator]=function(){return q};return q};
$jscomp.polyfill("Array.prototype.keys",function(c){return c?c:function(){return $jscomp.iteratorFromArray(this,function(c){return c})}},"es6","es3");$jscomp.checkStringArgs=function(c,h,m){if(null==c)throw new TypeError("The 'this' value for String.prototype."+m+" must not be null or undefined");if(h instanceof RegExp)throw new TypeError("First argument to String.prototype."+m+" must not be a regular expression");return c+""};
$jscomp.polyfill("String.prototype.repeat",function(c){return c?c:function(c){var h=$jscomp.checkStringArgs(this,null,"repeat");if(0>c||1342177279<c)throw new RangeError("Invalid count value");c|=0;for(var q="";c;)if(c&1&&(q+=h),c>>>=1)h+=h;return q}},"es6","es3");$jscomp.stringPadding=function(c,h){c=void 0!==c?String(c):" ";return 0<h&&c?c.repeat(Math.ceil(h/c.length)).substring(0,h):""};
$jscomp.polyfill("String.prototype.padStart",function(c){return c?c:function(c,m){var h=$jscomp.checkStringArgs(this,null,"padStart");return $jscomp.stringPadding(m,c-h.length)+h}},"es8","es3");function _typeof(c){_typeof="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(c){return typeof c}:function(c){return c&&"function"===typeof Symbol&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c};return _typeof(c)}
function _slicedToArray(c,h){return _arrayWithHoles(c)||_iterableToArrayLimit(c,h)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance");}function _iterableToArrayLimit(c,h){var m=[],q=!0,t=!1,E=void 0;try{for(var G=c[Symbol.iterator](),B;!(q=(B=G.next()).done)&&(m.push(B.value),!h||m.length!==h);q=!0);}catch(I){t=!0,E=I}finally{try{if(!q&&null!=G["return"])G["return"]()}finally{if(t)throw E;}}return m}
function _arrayWithHoles(c){if(Array.isArray(c))return c}function _possibleConstructorReturn(c,h){return!h||"object"!==_typeof(h)&&"function"!==typeof h?_assertThisInitialized(c):h}function _assertThisInitialized(c){if(void 0===c)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return c}
function _get(c,h,m){_get="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(c,h,m){if(c=_superPropBase(c,h))return h=Object.getOwnPropertyDescriptor(c,h),h.get?h.get.call(m):h.value};return _get(c,h,m||c)}function _superPropBase(c,h){for(;!Object.prototype.hasOwnProperty.call(c,h)&&(c=_getPrototypeOf(c),null!==c););return c}
function _getPrototypeOf(c){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(c){return c.__proto__||Object.getPrototypeOf(c)};return _getPrototypeOf(c)}function _inherits(c,h){if("function"!==typeof h&&null!==h)throw new TypeError("Super expression must either be null or a function");c.prototype=Object.create(h&&h.prototype,{constructor:{value:c,writable:!0,configurable:!0}});h&&_setPrototypeOf(c,h)}
function _setPrototypeOf(c,h){_setPrototypeOf=Object.setPrototypeOf||function(c,h){c.__proto__=h;return c};return _setPrototypeOf(c,h)}function _classCallCheck(c,h){if(!(c instanceof h))throw new TypeError("Cannot call a class as a function");}function _defineProperties(c,h){for(var m=0;m<h.length;m++){var q=h[m];q.enumerable=q.enumerable||!1;q.configurable=!0;"value"in q&&(q.writable=!0);Object.defineProperty(c,q.key,q)}}
function _createClass(c,h,m){h&&_defineProperties(c.prototype,h);m&&_defineProperties(c,m);return c}
var ROT=function(c){function h(c,b){return(c%b+b)%b}function m(c){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1;return c<b?b:c>a?a:c}function q(c){return c.charAt(0).toUpperCase()+c.substring(1)}function t(c){for(var b=arguments.length,a=Array(1<b?b-1:0),d=1;d<b;d++)a[d-1]=arguments[d];var e=t.map;return c.replace(/%(?:([a-z]+)|(?:{([^}]+)}))/gi,function(d,b,n,f){if("%"==c.charAt(f-1))return d.substring(1);if(!a.length)return d;
n=(b||n).split(",");b=n.shift()||"";f=e[b.toLowerCase()];if(!f)return d;d=a.shift();d=d[f].apply(d,n);b=b.charAt(0);b!=b.toLowerCase()&&(d=q(d));return d})}function E(c,b){var a=[],d=0;c.replace(X,function(e,b,n,f){var g=c.substring(d,f);g.length&&a.push({type:0,value:g});a.push({type:"c"==b?2:3,value:n.trim()});d=f+e.length;return""});var e=c.substring(d);e.length&&a.push({type:0,value:e});return G(a,b)}function G(c,b){b||(b=Infinity);for(var a=0,d=0,e=-1;a<c.length;){var g=c[a];1==g.type&&(d=0,
e=-1);if(0!=g.type)a++;else{for(;0==d&&" "==g.value.charAt(0);)g.value=g.value.substring(1);var p=g.value.indexOf("\n");if(-1!=p){g.value=B(c,a,p,!0);for(p=g.value.split("");p.length&&" "==p[p.length-1];)p.pop();g.value=p.join("")}if(g.value.length){if(d+g.value.length>b){for(p=-1;;){var n=g.value.indexOf(" ",p+1);if(-1==n)break;if(d+n>b)break;p=n}-1!=p?g.value=B(c,a,p,!0):-1!=e?(a=c[e],g=a.value.lastIndexOf(" "),a.value=B(c,e,g,!0),a=e):g.value=B(c,a,b-d,!1)}else d+=g.value.length,-1!=g.value.indexOf(" ")&&
(e=a);a++}else c.splice(a,1)}}c.push({type:1});b=null;for(d=0;d<c.length;d++)switch(e=c[d],e.type){case 0:b=e;break;case 1:if(b){for(e=b.value.split("");e.length&&" "==e[e.length-1];)e.pop();b.value=e.join("")}b=null}c.pop();return c}function B(c,b,a,d){d={type:0,value:c[b].value.substring(a+(d?1:0))};c.splice(b+1,0,{type:1},d);return c[b].value.substring(0,a)}function I(c){var b;if(c in M)var a=M[c];else{if("#"==c.charAt(0))if(a=(c.match(/[0-9a-f]/gi)||[]).map(function(d){return parseInt(d,16)}),
3==a.length)a=a.map(function(d){return 17*d});else for(b=0;3>b;b++)a[b+1]+=16*a[b],a.splice(b,1);else a=(b=c.match(/rgb\(([0-9, ]+)\)/i))?b[1].split(/\s*,\s*/).map(function(d){return parseInt(d)}):[0,0,0];M[c]=a}return a.slice()}function S(c){for(var b=arguments.length,a=Array(1<b?b-1:0),d=1;d<b;d++)a[d-1]=arguments[d];for(b=0;3>b;b++)for(d=0;d<a.length;d++)c[b]+=a[d][b];return c}function T(c,b){for(var a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:.5,d=c.slice(),e=0;3>e;e++)d[e]=Math.round(d[e]+
a*(b[e]-c[e]));return d}function U(c,b){for(var a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:.5,d=N(c),e=N(b),g=0;3>g;g++)d[g]+=a*(e[g]-d[g]);return V(d)}function N(c){var b=c[0]/255,a=c[1]/255;c=c[2]/255;var d=Math.max(b,a,c),e=Math.min(b,a,c),g=0,p=(d+e)/2;if(d==e)e=0;else{var n=d-e;e=.5<p?n/(2-d-e):n/(d+e);switch(d){case b:g=(a-c)/n+(a<c?6:0);break;case a:g=(c-b)/n+2;break;case c:g=(b-a)/n+4}g/=6}return[g,e,p]}function O(c,b,a){0>a&&(a+=1);1<a&&--a;return a<1/6?c+6*(b-c)*a:.5>a?b:a<
2/3?c+(b-c)*(2/3-a)*6:c}function V(c){var b=c[2];if(0==c[1])return b=Math.round(255*b),[b,b,b];var a=c[1];a=.5>b?b*(1+a):b+a-b*a;var d=2*b-a;b=O(d,a,c[0]+1/3);var e=O(d,a,c[0]);c=O(d,a,c[0]-1/3);return[Math.round(255*b),Math.round(255*e),Math.round(255*c)]}var r=(new (function(){function c(){_classCallCheck(this,c);this._c=this._s2=this._s1=this._s0=this._seed=0}_createClass(c,[{key:"getSeed",value:function(){return this._seed}},{key:"setSeed",value:function(b){this._seed=b=1>b?1/b:b;this._s0=2.3283064365386963E-10*
(b>>>0);b=69069*b+1>>>0;this._s1=2.3283064365386963E-10*b;this._s2=2.3283064365386963E-10*(69069*b+1>>>0);this._c=1;return this}},{key:"getUniform",value:function(){var b=2091639*this._s0+2.3283064365386963E-10*this._c;this._s0=this._s1;this._s1=this._s2;this._c=b|0;return this._s2=b-this._c}},{key:"getUniformInt",value:function(b,a){var d=Math.max(b,a);b=Math.min(b,a);return Math.floor(this.getUniform()*(d-b+1))+b}},{key:"getNormal",value:function(){var b=0<arguments.length&&void 0!==arguments[0]?
arguments[0]:0,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;do{var d=2*this.getUniform()-1;var e=2*this.getUniform()-1;e=d*d+e*e}while(1<e||0==e);return b+d*Math.sqrt(-2*Math.log(e)/e)*a}},{key:"getPercentage",value:function(){return 1+Math.floor(100*this.getUniform())}},{key:"getItem",value:function(b){return b.length?b[Math.floor(this.getUniform()*b.length)]:null}},{key:"shuffle",value:function(b){var a=[];for(b=b.slice();b.length;){var d=b.indexOf(this.getItem(b));a.push(b.splice(d,
1)[0])}return a}},{key:"getWeightedValue",value:function(b){var a=0;for(e in b)a+=b[e];a*=this.getUniform();var d;var e=0;for(d in b)if(e+=b[d],a<e)break;return d}},{key:"getState",value:function(){return[this._s0,this._s1,this._s2,this._c]}},{key:"setState",value:function(b){this._s0=b[0];this._s1=b[1];this._s2=b[2];this._c=b[3];return this}},{key:"clone",value:function(){return(new c).setState(this.getState())}}]);return c}())).setSeed(Date.now()),H=function(){function c(b){_classCallCheck(this,
c);this._context=b}_createClass(c,[{key:"compute",value:function(b){this._options=b}}]);return c}();t.map={s:"toString"};var Y=Object.freeze({mod:h,clamp:m,capitalize:q,format:t}),J=function(c){function b(a){_classCallCheck(this,b);a=_possibleConstructorReturn(this,_getPrototypeOf(b).call(this,a));a._spacingX=0;a._spacingY=0;a._hexSize=0;return a}_inherits(b,c);_createClass(b,[{key:"compute",value:function(a){_get(_getPrototypeOf(b.prototype),"compute",this).call(this,a);var d=Math.ceil(this._context.measureText("W").width);
this._hexSize=Math.floor(a.spacing*(a.fontSize+d/Math.sqrt(3))/2);this._spacingX=this._hexSize*Math.sqrt(3)/2;this._spacingY=1.5*this._hexSize;if(a.transpose){d="height";var e="width"}else d="width",e="height";this._context.canvas[d]=Math.ceil((a.width+1)*this._spacingX);this._context.canvas[e]=Math.ceil((a.height-1)*this._spacingY+2*this._hexSize)}},{key:"draw",value:function(a,d){a=_slicedToArray(a,5);var e=a[2],b=a[3],p=a[4];a=[(a[0]+1)*this._spacingX,a[1]*this._spacingY+this._hexSize];this._options.transpose&&
a.reverse();d&&(this._context.fillStyle=p,this._fill(a[0],a[1]));if(e)for(this._context.fillStyle=b,d=[].concat(e),e=0;e<d.length;e++)this._context.fillText(d[e],a[0],Math.ceil(a[1]))}},{key:"computeSize",value:function(a,d){this._options.transpose&&(a+=d,d=a-d,a-=d);return[Math.floor(a/this._spacingX)-1,Math.floor((d-2*this._hexSize)/this._spacingY+1)]}},{key:"computeFontSize",value:function(a,d){this._options.transpose&&(a+=d,d=a-d,a-=d);a=Math.min(2*a/((this._options.width+1)*Math.sqrt(3))-1,d/
(2+1.5*(this._options.height-1)));d=this._context.font;this._context.font="100px "+this._options.fontFamily;var e=Math.ceil(this._context.measureText("W").width);this._context.font=d;a=Math.floor(a)+1;return Math.ceil(2*a/(this._options.spacing*(1+e/100/Math.sqrt(3))))-1}},{key:"eventToPosition",value:function(a,d){if(this._options.transpose){a+=d;d=a-d;a-=d;var e=this._context.canvas.width}else e=this._context.canvas.height;d=Math.floor(d/(e/this._options.height));h(d,2)?(a-=this._spacingX,a=1+2*
Math.floor(a/(2*this._spacingX))):a=2*Math.floor(a/(2*this._spacingX));return[a,d]}},{key:"_fill",value:function(a,d){var e=this._hexSize,b=this._options.border;this._context.beginPath();this._options.transpose?(this._context.moveTo(a-e+b,d),this._context.lineTo(a-e/2+b,d+this._spacingX-b),this._context.lineTo(a+e/2-b,d+this._spacingX-b),this._context.lineTo(a+e-b,d),this._context.lineTo(a+e/2-b,d-this._spacingX+b),this._context.lineTo(a-e/2+b,d-this._spacingX+b),this._context.lineTo(a-e+b,d)):(this._context.moveTo(a,
d-e+b),this._context.lineTo(a+this._spacingX-b,d-e/2+b),this._context.lineTo(a+this._spacingX-b,d+e/2-b),this._context.lineTo(a,d+e-b),this._context.lineTo(a-this._spacingX+b,d+e/2-b),this._context.lineTo(a-this._spacingX+b,d-e/2+b),this._context.lineTo(a,d-e+b));this._context.fill()}}]);return b}(H),C=function(c){function b(a){_classCallCheck(this,b);a=_possibleConstructorReturn(this,_getPrototypeOf(b).call(this,a));a._spacingX=0;a._spacingY=0;a._canvasCache={};return a}_inherits(b,c);_createClass(b,
[{key:"compute",value:function(a){_get(_getPrototypeOf(b.prototype),"compute",this).call(this,a);this._canvasCache={};var d=Math.ceil(this._context.measureText("W").width);this._spacingX=Math.ceil(a.spacing*d);this._spacingY=Math.ceil(a.spacing*a.fontSize);this._options.forceSquareRatio&&(this._spacingX=this._spacingY=Math.max(this._spacingX,this._spacingY));this._context.canvas.width=a.width*this._spacingX;this._context.canvas.height=a.height*this._spacingY}},{key:"draw",value:function(a,d){b.cache?
this._drawWithCache(a):this._drawNoCache(a,d)}},{key:"_drawWithCache",value:function(a){var d=_slicedToArray(a,5);a=d[0];var e=d[1],b=d[2],p=d[3],n=d[4];d=""+b+p+n;if(d in this._canvasCache)var c=this._canvasCache[d];else{var k=this._options.border;c=document.createElement("canvas");var l=c.getContext("2d");c.width=this._spacingX;c.height=this._spacingY;l.fillStyle=n;l.fillRect(k,k,c.width-k,c.height-k);if(b)for(l.fillStyle=p,l.font=this._context.font,l.textAlign="center",l.textBaseline="middle",
b=[].concat(b),p=0;p<b.length;p++)l.fillText(b[p],this._spacingX/2,Math.ceil(this._spacingY/2));this._canvasCache[d]=c}this._context.drawImage(c,a*this._spacingX,e*this._spacingY)}},{key:"_drawNoCache",value:function(a,d){var e=_slicedToArray(a,5);a=e[0];var b=e[1],p=e[2],c=e[3];e=e[4];d&&(d=this._options.border,this._context.fillStyle=e,this._context.fillRect(a*this._spacingX+d,b*this._spacingY+d,this._spacingX-d,this._spacingY-d));if(p)for(this._context.fillStyle=c,d=[].concat(p),p=0;p<d.length;p++)this._context.fillText(d[p],
(a+.5)*this._spacingX,Math.ceil((b+.5)*this._spacingY))}},{key:"computeSize",value:function(a,d){return[Math.floor(a/this._spacingX),Math.floor(d/this._spacingY)]}},{key:"computeFontSize",value:function(a,d){a=Math.floor(a/this._options.width);d=Math.floor(d/this._options.height);var e=this._context.font;this._context.font="100px "+this._options.fontFamily;var b=Math.ceil(this._context.measureText("W").width);this._context.font=e;a=b/100*d/a;1<a&&(d=Math.floor(d/a));return Math.floor(d/this._options.spacing)}},
{key:"eventToPosition",value:function(a,d){return[Math.floor(a/this._spacingX),Math.floor(d/this._spacingY)]}}]);return b}(H);C.cache=!1;var z=function(c){function b(a){_classCallCheck(this,b);a=_possibleConstructorReturn(this,_getPrototypeOf(b).call(this,a));a._colorCanvas=document.createElement("canvas");return a}_inherits(b,c);_createClass(b,[{key:"compute",value:function(a){_get(_getPrototypeOf(b.prototype),"compute",this).call(this,a);this._context.canvas.width=a.width*a.tileWidth;this._context.canvas.height=
a.height*a.tileHeight;this._colorCanvas.width=a.tileWidth;this._colorCanvas.height=a.tileHeight}},{key:"draw",value:function(a,d){var e=_slicedToArray(a,5);a=e[0];var b=e[1],p=e[2],c=e[3],f=e[4];e=this._options.tileWidth;var k=this._options.tileHeight;d&&(this._options.tileColorize?this._context.clearRect(a*e,b*k,e,k):(this._context.fillStyle=f,this._context.fillRect(a*e,b*k,e,k)));if(p)for(d=[].concat(p),c=[].concat(c),f=[].concat(f),p=0;p<d.length;p++){var l=this._options.tileMap[d[p]];if(!l)throw Error("Char '"+
d[p]+"' not found in tileMap");if(this._options.tileColorize){var h=this._colorCanvas,m=h.getContext("2d");m.globalCompositeOperation="source-over";m.clearRect(0,0,e,k);var q=c[p],x=f[p];m.drawImage(this._options.tileSet,l[0],l[1],e,k,0,0,e,k);"transparent"!=q&&(m.fillStyle=q,m.globalCompositeOperation="source-atop",m.fillRect(0,0,e,k));"transparent"!=x&&(m.fillStyle=x,m.globalCompositeOperation="destination-over",m.fillRect(0,0,e,k));this._context.drawImage(h,a*e,b*k,e,k)}else this._context.drawImage(this._options.tileSet,
l[0],l[1],e,k,a*e,b*k,e,k)}}},{key:"computeSize",value:function(a,d){return[Math.floor(a/this._options.tileWidth),Math.floor(d/this._options.tileHeight)]}},{key:"computeFontSize",value:function(){throw Error("Tile backend does not understand font size");}},{key:"eventToPosition",value:function(a,d){return[Math.floor(a/this._options.tileWidth),Math.floor(d/this._options.tileHeight)]}}]);return b}(H),X=/%([bc]){([^}]*)}/g;H=Object.freeze({TYPE_TEXT:0,TYPE_NEWLINE:1,TYPE_FG:2,TYPE_BG:3,measure:function(c,
b){var a={width:0,height:1};c=E(c,b);for(var d=b=0;d<c.length;d++){var e=c[d];switch(e.type){case 0:b+=e.value.length;break;case 1:a.height++,a.width=Math.max(a.width,b),b=0}}a.width=Math.max(a.width,b);return a},tokenize:E});var y={4:[[0,-1],[1,0],[0,1],[-1,0]],8:[[0,-1],[1,-1],[1,0],[1,1],[0,1],[-1,1],[-1,0],[-1,-1]],6:[[-1,-1],[1,-1],[2,0],[1,1],[-1,1],[-2,0]]},Z={hex:J,rect:C,tile:z},aa={width:80,height:25,transpose:!1,layout:"rect",fontSize:15,spacing:1,border:0,forceSquareRatio:!1,fontFamily:"monospace",
fontStyle:"",fg:"#ccc",bg:"#000",tileWidth:32,tileHeight:32,tileMap:{},tileSet:null,tileColorize:!1,termColor:"xterm"},K=function(){function c(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,c);this._context=document.createElement("canvas").getContext("2d");this._data={};this._dirty=!1;this._options={};b=Object.assign({},aa,b);this.setOptions(b);this.DEBUG=this.DEBUG.bind(this);this._tick=this._tick.bind(this);requestAnimationFrame(this._tick)}_createClass(c,
[{key:"DEBUG",value:function(b,a,d){var e=[this._options.bg,this._options.fg];this.draw(b,a,null,null,e[d%e.length])}},{key:"clear",value:function(){this._data={};this._dirty=!0}},{key:"setOptions",value:function(b){Object.assign(this._options,b);if(b.width||b.height||b.fontSize||b.fontFamily||b.spacing||b.layout)b.layout&&(this._backend=new Z[b.layout](this._context)),b=(this._options.fontStyle?this._options.fontStyle+" ":"")+this._options.fontSize+"px "+this._options.fontFamily,this._context.font=
b,this._backend.compute(this._options),this._context.font=b,this._context.textAlign="center",this._context.textBaseline="middle",this._dirty=!0;return this}},{key:"getOptions",value:function(){return this._options}},{key:"getContainer",value:function(){return this._context.canvas}},{key:"computeSize",value:function(b,a){return this._backend.computeSize(b,a)}},{key:"computeFontSize",value:function(b,a){return this._backend.computeFontSize(b,a)}},{key:"computeTileSize",value:function(b,a){return[Math.floor(b/
this._options.width),Math.floor(a/this._options.height)]}},{key:"eventToPosition",value:function(b){if("touches"in b){var a=b.touches[0].clientX;b=b.touches[0].clientY}else a=b.clientX,b=b.clientY;var d=this._context.canvas.getBoundingClientRect();a-=d.left;b-=d.top;a*=this._context.canvas.width/d.width;b*=this._context.canvas.height/d.height;return 0>a||0>b||a>=this._context.canvas.width||b>=this._context.canvas.height?[-1,-1]:this._backend.eventToPosition(a,b)}},{key:"draw",value:function(b,a,d,
e,g){e||(e=this._options.fg);g||(g=this._options.bg);var p="".concat(b,",").concat(a);this._data[p]=[b,a,d,e,g];!0!==this._dirty&&(this._dirty||(this._dirty={}),this._dirty[p]=!0)}},{key:"drawText",value:function(b,a,d,e){var g=null,p=null,c=b,f=1;e||(e=this._options.width-b);for(d=E(d,e);d.length;)switch(e=d.shift(),e.type){case 0:for(var k,l=!1,h,m=!1,q=0;q<e.value.length;q++){k=e.value.charCodeAt(q);var x=e.value.charAt(q);h=65280<k&&65377>k||65500<k&&65512>k||65518<k;k=32==x.charCodeAt(0)||12288==
x.charCodeAt(0);!m||h||k||c++;h&&!l&&c++;this.draw(c++,a,x,g,p);l=k;m=h}break;case 2:g=e.value||null;break;case 3:p=e.value||null;break;case 1:c=b,a++,f++}return f}},{key:"_tick",value:function(){requestAnimationFrame(this._tick);if(this._dirty){if(!0===this._dirty){this._context.fillStyle=this._options.bg;this._context.fillRect(0,0,this._context.canvas.width,this._context.canvas.height);for(var b in this._data)this._draw(b,!1)}else for(var a in this._dirty)this._draw(a,!0);this._dirty=!1}}},{key:"_draw",
value:function(b,a){b=this._data[b];b[4]!=this._options.bg&&(a=!0);this._backend.draw(b,a)}}]);return c}();K.Rect=C;K.Hex=J;K.Tile=z;J=function(){function c(b){_classCallCheck(this,c);this._options={words:!1,order:3,prior:.001};Object.assign(this._options,b);this._suffix=this._boundary=String.fromCharCode(0);this._prefix=[];for(b=0;b<this._options.order;b++)this._prefix.push(this._boundary);this._priorValues={};this._priorValues[this._boundary]=this._options.prior;this._data={}}_createClass(c,[{key:"clear",
value:function(){this._data={};this._priorValues={}}},{key:"generate",value:function(){for(var b=[this._sample(this._prefix)];b[b.length-1]!=this._boundary;)b.push(this._sample(b));return this._join(b.slice(0,-1))}},{key:"observe",value:function(b){b=this._split(b);for(var a=0;a<b.length;a++)this._priorValues[b[a]]=this._options.prior;b=this._prefix.concat(b).concat(this._suffix);for(a=this._options.order;a<b.length;a++)for(var d=b.slice(a-this._options.order,a),e=b[a],g=0;g<d.length;g++){var p=d.slice(g);
this._observeEvent(p,e)}}},{key:"getStats",value:function(){var b=[],a=Object.keys(this._priorValues).length;a--;b.push("distinct samples: "+a);a=Object.keys(this._data).length;var d=0,e;for(e in this._data)d+=Object.keys(this._data[e]).length;b.push("dictionary size (contexts): "+a);b.push("dictionary size (events): "+d);return b.join(", ")}},{key:"_split",value:function(b){return b.split(this._options.words?/\s+/:"")}},{key:"_join",value:function(b){return b.join(this._options.words?" ":"")}},{key:"_observeEvent",
value:function(b,a){b=this._join(b);b in this._data||(this._data[b]={});b=this._data[b];a in b||(b[a]=0);b[a]++}},{key:"_sample",value:function(b){b=this._backoff(b);b=this._join(b);b=this._data[b];var a={};if(this._options.prior){for(var d in this._priorValues)a[d]=this._priorValues[d];for(var e in b)a[e]+=b[e]}else a=b;return r.getWeightedValue(a)}},{key:"_backoff",value:function(b){for(b.length>this._options.order?b=b.slice(-this._options.order):b.length<this._options.order&&(b=this._prefix.slice(0,
this._options.order-b.length).concat(b));!(this._join(b)in this._data)&&0<b.length;)b=b.slice(1);return b}}]);return c}();var W=function(){function c(){_classCallCheck(this,c);this._time=0;this._events=[];this._eventTimes=[]}_createClass(c,[{key:"getTime",value:function(){return this._time}},{key:"clear",value:function(){this._events=[];this._eventTimes=[];return this}},{key:"add",value:function(b,a){for(var d=this._events.length,e=0;e<this._eventTimes.length;e++)if(this._eventTimes[e]>a){d=e;break}this._events.splice(d,
0,b);this._eventTimes.splice(d,0,a)}},{key:"get",value:function(){if(!this._events.length)return null;var b=this._eventTimes.splice(0,1)[0];if(0<b){this._time+=b;for(var a=0;a<this._eventTimes.length;a++)this._eventTimes[a]-=b}return this._events.splice(0,1)[0]}},{key:"getEventTime",value:function(b){b=this._events.indexOf(b);if(-1!=b)return this._eventTimes[b]}},{key:"remove",value:function(b){b=this._events.indexOf(b);if(-1==b)return!1;this._remove(b);return!0}},{key:"_remove",value:function(b){this._events.splice(b,
1);this._eventTimes.splice(b,1)}}]);return c}(),w=function(){function c(){_classCallCheck(this,c);this._queue=new W;this._repeat=[];this._current=null}_createClass(c,[{key:"getTime",value:function(){return this._queue.getTime()}},{key:"add",value:function(b,a){a&&this._repeat.push(b);return this}},{key:"getTimeOf",value:function(b){return this._queue.getEventTime(b)}},{key:"clear",value:function(){this._queue.clear();this._repeat=[];this._current=null;return this}},{key:"remove",value:function(b){var a=
this._queue.remove(b),d=this._repeat.indexOf(b);-1!=d&&this._repeat.splice(d,1);this._current==b&&(this._current=null);return a}},{key:"next",value:function(){return this._current=this._queue.get()}}]);return c}();C=function(c){function b(){_classCallCheck(this,b);return _possibleConstructorReturn(this,_getPrototypeOf(b).apply(this,arguments))}_inherits(b,c);_createClass(b,[{key:"add",value:function(a,d){this._queue.add(a,0);return _get(_getPrototypeOf(b.prototype),"add",this).call(this,a,d)}},{key:"next",
value:function(){this._current&&-1!=this._repeat.indexOf(this._current)&&this._queue.add(this._current,0);return _get(_getPrototypeOf(b.prototype),"next",this).call(this)}}]);return b}(w);z=function(c){function b(){_classCallCheck(this,b);return _possibleConstructorReturn(this,_getPrototypeOf(b).apply(this,arguments))}_inherits(b,c);_createClass(b,[{key:"add",value:function(a,d,e){this._queue.add(a,void 0!==e?e:1/a.getSpeed());return _get(_getPrototypeOf(b.prototype),"add",this).call(this,a,d)}},
{key:"next",value:function(){this._current&&-1!=this._repeat.indexOf(this._current)&&this._queue.add(this._current,1/this._current.getSpeed());return _get(_getPrototypeOf(b.prototype),"next",this).call(this)}}]);return b}(w);w=function(c){function b(){_classCallCheck(this,b);var a=_possibleConstructorReturn(this,_getPrototypeOf(b).call(this));a._defaultDuration=1;a._duration=a._defaultDuration;return a}_inherits(b,c);_createClass(b,[{key:"add",value:function(a,d,e){this._queue.add(a,e||this._defaultDuration);
return _get(_getPrototypeOf(b.prototype),"add",this).call(this,a,d)}},{key:"clear",value:function(){this._duration=this._defaultDuration;return _get(_getPrototypeOf(b.prototype),"clear",this).call(this)}},{key:"remove",value:function(a){a==this._current&&(this._duration=this._defaultDuration);return _get(_getPrototypeOf(b.prototype),"remove",this).call(this,a)}},{key:"next",value:function(){this._current&&-1!=this._repeat.indexOf(this._current)&&(this._queue.add(this._current,this._duration||this._defaultDuration),
this._duration=this._defaultDuration);return _get(_getPrototypeOf(b.prototype),"next",this).call(this)}},{key:"setDuration",value:function(a){this._current&&(this._duration=a);return this}}]);return b}(w);C={Simple:C,Speed:z,Action:w};var v=function(){function c(b){var a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,c);this._lightPasses=b;this._options=Object.assign({topology:8},a)}_createClass(c,[{key:"_getCircle",value:function(b,a,d){var e=[];switch(this._options.topology){case 4:var g=
1;var p=[0,1];var c=[y[8][7],y[8][1],y[8][3],y[8][5]];break;case 6:c=y[6];g=1;p=[-1,1];break;case 8:c=y[4];g=2;p=[-1,1];break;default:throw Error("Incorrect topology for FOV computation");}b+=p[0]*d;a+=p[1]*d;for(p=0;p<c.length;p++)for(var f=0;f<d*g;f++)e.push([b,a]),b+=c[p][0],a+=c[p][1];return e}}]);return c}();z=function(c){function b(){_classCallCheck(this,b);return _possibleConstructorReturn(this,_getPrototypeOf(b).apply(this,arguments))}_inherits(b,c);_createClass(b,[{key:"compute",value:function(a,
d,e,b){b(a,d,0,1);if(this._lightPasses(a,d))for(var g=[],c,f,k,l,h,m=1;m<=e;m++)for(var q=this._getCircle(a,d,m),r=360/q.length,u=0;u<q.length;u++)if(k=q[u][0],l=q[u][1],c=r*(u-.5),f=c+r,h=!this._lightPasses(k,l),this._visibleCoords(Math.floor(c),Math.ceil(f),h,g)&&b(k,l,m,1),2==g.length&&0==g[0]&&360==g[1])return}},{key:"_visibleCoords",value:function(a,d,e,b){if(0>a)return d=this._visibleCoords(0,d,e,b),a=this._visibleCoords(360+a,360,e,b),d||a;for(var g=0;g<b.length&&b[g]<a;)g++;if(g==b.length)return e&&
b.push(a,d),!0;var c=0;if(g%2){for(;g<b.length&&b[g]<d;)g++,c++;if(0==c)return!1;e&&(c%2?b.splice(g-c,c,d):b.splice(g-c,c))}else{for(;g<b.length&&b[g]<d;)g++,c++;if(a==b[g-c]&&1==c)return!1;e&&(c%2?b.splice(g-c,c,a):b.splice(g-c,c,a,d))}return!0}}]);return b}(v);w=function(c){function b(){_classCallCheck(this,b);return _possibleConstructorReturn(this,_getPrototypeOf(b).apply(this,arguments))}_inherits(b,c);_createClass(b,[{key:"compute",value:function(a,d,b,g){g(a,d,0,1);if(this._lightPasses(a,d))for(var e=
[],c,f,k,l,h,m=1;m<=b;m++)for(var q=this._getCircle(a,d,m),r=q.length,u=0;u<r;u++)if(c=q[u][0],f=q[u][1],l=[u?2*u-1:2*r-1,2*r],h=[2*u+1,2*r],k=!this._lightPasses(c,f),(k=this._checkVisibility(l,h,k,e))&&g(c,f,m,k),2==e.length&&0==e[0][0]&&e[1][0]==e[1][1])return}},{key:"_checkVisibility",value:function(a,d,b,g){if(a[0]>d[0])return a=this._checkVisibility(a,[a[1],a[1]],b,g),d=this._checkVisibility([0,1],d,b,g),(a+d)/2;for(var e=0,c=!1;e<g.length;){var f=g[e];f=f[0]*a[1]-a[0]*f[1];if(0<=f){0!=f||e%
2||(c=!0);break}e++}f=g.length;for(var k=!1;f--;){var l=g[f];l=d[0]*l[1]-l[0]*d[1];if(0<=l){0==l&&f%2&&(k=!0);break}}l=!0;e==f&&(c||k)?l=!1:c&&k&&e+1==f&&f%2?l=!1:e>f&&e%2&&(l=!1);if(!l)return 0;c=f-e+1;if(c%2)e%2?(f=g[e],f=(d[0]*f[1]-f[0]*d[1])/(f[1]*d[1]),b&&g.splice(e,c,d)):(f=g[f],f=(f[0]*a[1]-a[0]*f[1])/(a[1]*f[1]),b&&g.splice(e,c,a));else if(e%2)k=g[e],f=g[f],f=(f[0]*k[1]-k[0]*f[1])/(k[1]*f[1]),b&&g.splice(e,c);else return b&&g.splice(e,c,a,d),1;return f/((d[0]*a[1]-a[0]*d[1])/(a[1]*d[1]))}}]);
return b}(v);var A=[[-1,0,0,1],[0,-1,1,0],[0,-1,-1,0],[-1,0,0,-1],[1,0,0,-1],[0,1,-1,0],[0,1,1,0],[1,0,0,1]];v=function(c){function b(){_classCallCheck(this,b);return _possibleConstructorReturn(this,_getPrototypeOf(b).apply(this,arguments))}_inherits(b,c);_createClass(b,[{key:"compute",value:function(b,d,e,g){g(b,d,0,1);for(var a=0;a<A.length;a++)this._renderOctant(b,d,A[a],e,g)}},{key:"compute180",value:function(b,d,e,g,c){c(b,d,0,1);var a=(g-1+8)%8,p=(g+1+8)%8;this._renderOctant(b,d,A[(g-2+8)%8],
e,c);this._renderOctant(b,d,A[a],e,c);this._renderOctant(b,d,A[g],e,c);this._renderOctant(b,d,A[p],e,c)}},{key:"compute90",value:function(b,d,e,g,c){c(b,d,0,1);var a=(g-1+8)%8;this._renderOctant(b,d,A[g],e,c);this._renderOctant(b,d,A[a],e,c)}},{key:"_renderOctant",value:function(b,d,e,g,c){this._castVisibility(b,d,1,1,0,g+1,e[0],e[1],e[2],e[3],c)}},{key:"_castVisibility",value:function(b,d,e,g,c,n,f,k,l,h,m){if(!(g<c))for(;e<=n;e++){for(var a=-e-1,p=-e,q=!1,P=0;0>=a;){a+=1;var r=b+a*f+p*k,Q=d+a*l+
p*h,t=(a-.5)/(p+.5),x=(a+.5)/(p-.5);if(!(x>g)){if(t<c)break;a*a+p*p<n*n&&m(r,Q,e,1);q?this._lightPasses(r,Q)?(q=!1,g=P):P=x:!this._lightPasses(r,Q)&&e<n&&(q=!0,this._castVisibility(b,d,e+1,g,t,n,f,k,l,h,m),P=x)}}if(q)break}}}]);return b}(v);z={DiscreteShadowcasting:z,PreciseShadowcasting:w,RecursiveShadowcasting:v};var D=function(){function c(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:80,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:25;_classCallCheck(this,c);this._width=
b;this._height=a}_createClass(c,[{key:"_fillMap",value:function(b){for(var a=[],d=0;d<this._width;d++){a.push([]);for(var e=0;e<this._height;e++)a[d].push(b)}return a}}]);return c}();w=function(c){function b(){_classCallCheck(this,b);return _possibleConstructorReturn(this,_getPrototypeOf(b).apply(this,arguments))}_inherits(b,c);_createClass(b,[{key:"create",value:function(b){for(var d=this._width-1,e=this._height-1,a=0;a<=d;a++)for(var c=0;c<=e;c++)b(a,c,a&&c&&a<d&&c<e?0:1);return this}}]);return b}(D);
v=function(c){function b(a,d){_classCallCheck(this,b);a=_possibleConstructorReturn(this,_getPrototypeOf(b).call(this,a,d));a._rooms=[];a._corridors=[];return a}_inherits(b,c);_createClass(b,[{key:"getRooms",value:function(){return this._rooms}},{key:"getCorridors",value:function(){return this._corridors}}]);return b}(D);var F=function b(){_classCallCheck(this,b)},L=function(b){function a(d,b,c,p,n,f){_classCallCheck(this,a);var e=_possibleConstructorReturn(this,_getPrototypeOf(a).call(this));e._x1=
d;e._y1=b;e._x2=c;e._y2=p;e._doors={};void 0!==n&&void 0!==f&&e.addDoor(n,f);return e}_inherits(a,b);_createClass(a,[{key:"addDoor",value:function(d,b){this._doors[d+","+b]=1;return this}},{key:"getDoors",value:function(d){for(var b in this._doors){var a=b.split(",");d(parseInt(a[0]),parseInt(a[1]))}return this}},{key:"clearDoors",value:function(){this._doors={};return this}},{key:"addDoors",value:function(d){for(var b=this._x1-1,a=this._x2+1,c=this._y1-1,n=this._y2+1,f=b;f<=a;f++)for(var k=c;k<=
n;k++)if(f==b||f==a||k==c||k==n)d(f,k)||this.addDoor(f,k);return this}},{key:"debug",value:function(){console.log("room",this._x1,this._y1,this._x2,this._y2)}},{key:"isValid",value:function(d,b){for(var a=this._x1-1,e=this._x2+1,c=this._y1-1,f=this._y2+1,k=a;k<=e;k++)for(var l=c;l<=f;l++)if(k==a||k==e||l==c||l==f){if(!d(k,l))return!1}else if(!b(k,l))return!1;return!0}},{key:"create",value:function(d){for(var b=this._x1-1,a=this._x2+1,c=this._y1-1,n=this._y2+1,f,k=b;k<=a;k++)for(var l=c;l<=n;l++)f=
k+","+l in this._doors?2:k==b||k==a||l==c||l==n?1:0,d(k,l,f)}},{key:"getCenter",value:function(){return[Math.round((this._x1+this._x2)/2),Math.round((this._y1+this._y2)/2)]}},{key:"getLeft",value:function(){return this._x1}},{key:"getRight",value:function(){return this._x2}},{key:"getTop",value:function(){return this._y1}},{key:"getBottom",value:function(){return this._y2}}],[{key:"createRandomAt",value:function(d,b,a,c,n){var e=n.roomWidth[0],g=n.roomWidth[1],p=r.getUniformInt(e,g);e=n.roomHeight[0];
g=n.roomHeight[1];n=r.getUniformInt(e,g);if(1==a)return a=b-Math.floor(r.getUniform()*n),new this(d+1,a,d+p,a+n-1,d,b);if(-1==a)return a=b-Math.floor(r.getUniform()*n),new this(d-p,a,d-1,a+n-1,d,b);if(1==c)return a=d-Math.floor(r.getUniform()*p),new this(a,b+1,a+p-1,b+n,d,b);if(-1==c)return a=d-Math.floor(r.getUniform()*p),new this(a,b-n,a+p-1,b-1,d,b);throw Error("dx or dy must be 1 or -1");}},{key:"createRandomCenter",value:function(d,b,a){var e=a.roomWidth[0],c=a.roomWidth[1],g=r.getUniformInt(e,
c);e=a.roomHeight[0];c=a.roomHeight[1];a=r.getUniformInt(e,c);d-=Math.floor(r.getUniform()*g);b-=Math.floor(r.getUniform()*a);return new this(d,b,d+g-1,b+a-1)}},{key:"createRandom",value:function(d,b,a){var e=a.roomWidth[0],c=a.roomWidth[1],g=r.getUniformInt(e,c);e=a.roomHeight[0];c=a.roomHeight[1];a=r.getUniformInt(e,c);d=d-g-1;b=b-a-1;d=1+Math.floor(r.getUniform()*d);b=1+Math.floor(r.getUniform()*b);return new this(d,b,d+g-1,b+a-1)}}]);return a}(F),R=function(b){function a(d,b,c,p){_classCallCheck(this,
a);var e=_possibleConstructorReturn(this,_getPrototypeOf(a).call(this));e._startX=d;e._startY=b;e._endX=c;e._endY=p;e._endsWithAWall=!0;return e}_inherits(a,b);_createClass(a,[{key:"debug",value:function(){console.log("corridor",this._startX,this._startY,this._endX,this._endY)}},{key:"isValid",value:function(d,b){var a=this._startX,e=this._startY,c=this._endX-a,f=this._endY-e,k=1+Math.max(Math.abs(c),Math.abs(f));c&&(c/=Math.abs(c));f&&(f/=Math.abs(f));for(var l=f,h=-c,m=!0,q=0;q<k;q++){var r=a+q*
c,t=e+q*f;b(r,t)||(m=!1);d(r+l,t+h)||(m=!1);d(r-l,t-h)||(m=!1);if(!m){k=q;this._endX=r-c;this._endY=t-f;break}}if(0==k||1==k&&d(this._endX+c,this._endY+f))return!1;b=!d(this._endX+c+l,this._endY+f+h);l=!d(this._endX+c-l,this._endY+f-h);this._endsWithAWall=d(this._endX+c,this._endY+f);return(b||l)&&this._endsWithAWall?!1:!0}},{key:"create",value:function(d){var b=this._startX,a=this._startY,c=this._endX-b,n=this._endY-a,f=1+Math.max(Math.abs(c),Math.abs(n));c&&(c/=Math.abs(c));n&&(n/=Math.abs(n));
for(var k=0;k<f;k++)d(b+k*c,a+k*n,0);return!0}},{key:"createPriorityWalls",value:function(d){if(this._endsWithAWall){var b=this._endX-this._startX,a=this._endY-this._startY;b&&(b/=Math.abs(b));a&&(a/=Math.abs(a));var c=a,n=-b;d(this._endX+b,this._endY+a);d(this._endX+c,this._endY+n);d(this._endX-c,this._endY-n)}}}],[{key:"createRandomAt",value:function(d,b,a,c,n){n=r.getUniformInt(n.corridorLength[0],n.corridorLength[1]);return new this(d,b,d+a*n,b+c*n)}}]);return a}(F);F=function(b){function a(d,
b,c){_classCallCheck(this,a);d=_possibleConstructorReturn(this,_getPrototypeOf(a).call(this,d,b));d._options={roomWidth:[3,9],roomHeight:[3,5],roomDugPercentage:.1,timeLimit:1E3};Object.assign(d._options,c);d._map=[];d._dug=0;d._roomAttempts=20;d._corridorAttempts=20;d._connected=[];d._unconnected=[];d._digCallback=d._digCallback.bind(_assertThisInitialized(_assertThisInitialized(d)));d._canBeDugCallback=d._canBeDugCallback.bind(_assertThisInitialized(_assertThisInitialized(d)));d._isWallCallback=
d._isWallCallback.bind(_assertThisInitialized(_assertThisInitialized(d)));return d}_inherits(a,b);_createClass(a,[{key:"create",value:function(d){for(var b=Date.now();;){if(Date.now()-b>this._options.timeLimit)return null;this._map=this._fillMap(1);this._dug=0;this._rooms=[];this._unconnected=[];this._generateRooms();if(!(2>this._rooms.length)&&this._generateCorridors())break}if(d)for(b=0;b<this._width;b++)for(var a=0;a<this._height;a++)d(b,a,this._map[b][a]);return this}},{key:"_generateRooms",value:function(){var b=
this._width-2,a=this._height-2;do{var c=this._generateRoom();if(this._dug/(b*a)>this._options.roomDugPercentage)break}while(c)}},{key:"_generateRoom",value:function(){for(var b=0;b<this._roomAttempts;){b++;var a=L.createRandom(this._width,this._height,this._options);if(a.isValid(this._isWallCallback,this._canBeDugCallback))return a.create(this._digCallback),this._rooms.push(a),a}return null}},{key:"_generateCorridors",value:function(){for(var b=0;b<this._corridorAttempts;){b++;this._corridors=[];
this._map=this._fillMap(1);for(var a=0;a<this._rooms.length;a++){var c=this._rooms[a];c.clearDoors();c.create(this._digCallback)}this._unconnected=r.shuffle(this._rooms.slice());this._connected=[];for(this._unconnected.length&&this._connected.push(this._unconnected.pop());;){a=r.getItem(this._connected);if(!a)break;a=this._closestRoom(this._unconnected,a);if(!a)break;c=this._closestRoom(this._connected,a);if(!c)break;if(!this._connectRooms(a,c))break;if(!this._unconnected.length)return!0}}return!1}},
{key:"_closestRoom",value:function(b,a){var d=Infinity;a=a.getCenter();for(var c=null,e=0;e<b.length;e++){var f=b[e],k=f.getCenter(),l=k[0]-a[0];k=k[1]-a[1];l=l*l+k*k;l<d&&(d=l,c=f)}return c}},{key:"_connectRooms",value:function(b,a){var d=b.getCenter(),c=a.getCenter(),e=c[0]-d[0];d=c[1]-d[1];if(Math.abs(e)<Math.abs(d)){e=0<d?2:0;var f=(e+2)%4;var k=a.getLeft();var l=a.getRight();d=0}else e=0<e?1:3,f=(e+2)%4,k=a.getTop(),l=a.getBottom(),d=1;e=this._placeInWall(b,e);if(!e)return!1;if(e[d]>=k&&e[d]<=
l){c=e.slice();k=0;switch(f){case 0:k=a.getTop()-1;break;case 1:k=a.getRight()+1;break;case 2:k=a.getBottom()+1;break;case 3:k=a.getLeft()-1}c[(d+1)%2]=k;this._digLine([e,c])}else if(e[d]<k-1||e[d]>l+1){c=e[d]-c[d];k=0;switch(f){case 0:case 1:k=0>c?3:1;break;case 2:case 3:k=0>c?1:3}c=this._placeInWall(a,(f+k)%4);if(!c)return!1;f=[0,0];f[d]=e[d];d=(d+1)%2;f[d]=c[d];this._digLine([e,f,c])}else{k=(d+1)%2;c=this._placeInWall(a,f);if(!c)return!1;f=Math.round((c[k]+e[k])/2);l=[0,0];var h=[0,0];l[d]=e[d];
l[k]=f;h[d]=c[d];h[k]=f;this._digLine([e,l,h,c])}b.addDoor(e[0],e[1]);a.addDoor(c[0],c[1]);d=this._unconnected.indexOf(b);-1!=d&&(this._unconnected.splice(d,1),this._connected.push(b));d=this._unconnected.indexOf(a);-1!=d&&(this._unconnected.splice(d,1),this._connected.push(a));return!0}},{key:"_placeInWall",value:function(d,b){var a=[0,0],c=[0,0],e=0;switch(b){case 0:c=[1,0];a=[d.getLeft(),d.getTop()-1];e=d.getRight()-d.getLeft()+1;break;case 1:c=[0,1];a=[d.getRight()+1,d.getTop()];e=d.getBottom()-
d.getTop()+1;break;case 2:c=[1,0];a=[d.getLeft(),d.getBottom()+1];e=d.getRight()-d.getLeft()+1;break;case 3:c=[0,1],a=[d.getLeft()-1,d.getTop()],e=d.getBottom()-d.getTop()+1}d=[];b=-2;for(var f=0;f<e;f++){var k=a[0]+f*c[0],l=a[1]+f*c[1];d.push(null);1==this._map[k][l]?b!=f-1&&(d[f]=[k,l]):(b=f)&&(d[f-1]=null)}for(a=d.length-1;0<=a;a--)d[a]||d.splice(a,1);return d.length?r.getItem(d):null}},{key:"_digLine",value:function(a){for(var b=1;b<a.length;b++){var d=a[b-1],c=a[b];d=new R(d[0],d[1],c[0],c[1]);
d.create(this._digCallback);this._corridors.push(d)}}},{key:"_digCallback",value:function(a,b,c){this._map[a][b]=c;0==c&&this._dug++}},{key:"_isWallCallback",value:function(a,b){return 0>a||0>b||a>=this._width||b>=this._height?!1:1==this._map[a][b]}},{key:"_canBeDugCallback",value:function(a,b){return 1>a||1>b||a+1>=this._width||b+1>=this._height?!1:1==this._map[a][b]}}]);return a}(v);D=function(b){function a(b,c){var d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};_classCallCheck(this,
a);var e=_possibleConstructorReturn(this,_getPrototypeOf(a).call(this,b,c));e._options={born:[5,6,7,8],survive:[4,5,6,7,8],topology:8};e.setOptions(d);e._dirs=y[e._options.topology];e._map=e._fillMap(0);return e}_inherits(a,b);_createClass(a,[{key:"randomize",value:function(a){for(var b=0;b<this._width;b++)for(var d=0;d<this._height;d++)this._map[b][d]=r.getUniform()<a?1:0;return this}},{key:"setOptions",value:function(a){Object.assign(this._options,a)}},{key:"set",value:function(a,b,c){this._map[a][b]=
c}},{key:"create",value:function(a){for(var b=this._fillMap(0),d=this._options.born,c=this._options.survive,n=0;n<this._height;n++){var f=1,k=0;6==this._options.topology&&(f=2,k=n%2);for(;k<this._width;k+=f){var l=this._map[k][n],h=this._getNeighbors(k,n);l&&-1!=c.indexOf(h)?b[k][n]=1:l||-1==d.indexOf(h)||(b[k][n]=1)}}this._map=b;a&&this._serviceCallback(a)}},{key:"_serviceCallback",value:function(a){for(var b=0;b<this._height;b++){var d=1,c=0;6==this._options.topology&&(d=2,c=b%2);for(;c<this._width;c+=
d)a(c,b,this._map[c][b])}}},{key:"_getNeighbors",value:function(b,a){for(var d=0,c=0;c<this._dirs.length;c++){var e=this._dirs[c],f=b+e[0];e=a+e[1];0>f||f>=this._width||0>e||e>=this._height||(d+=1==this._map[f][e]?1:0)}return d}},{key:"connect",value:function(b,a,c){a||(a=0);var d=[],e={},f=1,g=[0,0];6==this._options.topology&&(f=2,g=[0,1]);for(var l=0;l<this._height;l++)for(var h=g[l%2];h<this._width;h+=f)if(this._freeSpace(h,l,a)){var m=[h,l];e[this._pointKey(m)]=m;d.push([h,l])}f=d[r.getUniformInt(0,
d.length-1)];g=this._pointKey(f);d={};d[g]=f;delete e[g];for(this._findConnected(d,e,[f],!1,a);0<Object.keys(e).length;){g=this._getFromTo(d,e);f=g[0];l=g[1];g={};g[this._pointKey(f)]=f;this._findConnected(g,e,[f],!0,a);(6==this._options.topology?this._tunnelToConnected6:this._tunnelToConnected).call(this,l,f,d,e,a,c);for(var q in g)f=g[q],this._map[f[0]][f[1]]=a,d[q]=f,delete e[q]}b&&this._serviceCallback(b)}},{key:"_getFromTo",value:function(a,b){for(var d=[0,0],c=[0,0],e,f=Object.keys(a),k=Object.keys(b),
l=0;5>l&&!(f.length<k.length?(d=f,c=a[d[r.getUniformInt(0,d.length-1)]],d=this._getClosest(c,b)):(d=k,d=b[d[r.getUniformInt(0,d.length-1)]],c=this._getClosest(d,a)),e=(d[0]-c[0])*(d[0]-c[0])+(d[1]-c[1])*(d[1]-c[1]),64>e);l++);return[d,c]}},{key:"_getClosest",value:function(a,b){var d=null,c=null,e;for(e in b){var f=b[e],k=(f[0]-a[0])*(f[0]-a[0])+(f[1]-a[1])*(f[1]-a[1]);if(null==c||k<c)c=k,d=f}return d}},{key:"_findConnected",value:function(a,b,c,p,h){for(;0<c.length;){var d=c.splice(0,1)[0];d=6==
this._options.topology?[[d[0]+2,d[1]],[d[0]+1,d[1]-1],[d[0]-1,d[1]-1],[d[0]-2,d[1]],[d[0]-1,d[1]+1],[d[0]+1,d[1]+1]]:[[d[0]+1,d[1]],[d[0]-1,d[1]],[d[0],d[1]+1],[d[0],d[1]-1]];for(var e=0;e<d.length;e++){var g=this._pointKey(d[e]);null==a[g]&&this._freeSpace(d[e][0],d[e][1],h)&&(a[g]=d[e],p||delete b[g],c.push(d[e]))}}}},{key:"_tunnelToConnected",value:function(a,b,c,p,h,f){if(b[0]<a[0]){var d=b;var e=a}else d=a,e=b;for(var g=d[0];g<=e[0];g++){this._map[g][d[1]]=h;var n=[g,d[1]],m=this._pointKey(n);
c[m]=n;delete p[m]}f&&d[0]<e[0]&&f(d,[e[0],d[1]]);g=e[0];b[1]<a[1]?(d=b,e=a):(d=a,e=b);for(a=d[1];a<e[1];a++)this._map[g][a]=h,b=[g,a],n=this._pointKey(b),c[n]=b,delete p[n];f&&d[1]<e[1]&&f([e[0],d[1]],[e[0],e[1]])}},{key:"_tunnelToConnected6",value:function(a,b,c,p,h,f){if(b[0]<a[0]){var d=b;var e=a}else d=a,e=b;var g=d[0];for(d=d[1];g!=e[0]||d!=e[1];){var n=2;d<e[1]?(d++,n=1):d>e[1]&&(d--,n=1);g=g<e[0]?g+n:g>e[0]?g-n:e[1]%2?g-n:g+n;this._map[g][d]=h;n=[g,d];var m=this._pointKey(n);c[m]=n;delete p[m]}f&&
f(b,a)}},{key:"_freeSpace",value:function(a,b,c){return 0<=a&&a<this._width&&0<=b&&b<this._height&&this._map[a][b]==c}},{key:"_pointKey",value:function(a){return a[0]+"."+a[1]}}]);return a}(D);var ba={room:L,corridor:R};v=function(b){function a(b,c){var d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};_classCallCheck(this,a);var e=_possibleConstructorReturn(this,_getPrototypeOf(a).call(this,b,c));e._options=Object.assign({roomWidth:[3,9],roomHeight:[3,5],corridorLength:[3,10],dugPercentage:.2,
timeLimit:1E3},d);e._features={room:4,corridor:4};e._map=[];e._featureAttempts=20;e._walls={};e._dug=0;e._digCallback=e._digCallback.bind(_assertThisInitialized(_assertThisInitialized(e)));e._canBeDugCallback=e._canBeDugCallback.bind(_assertThisInitialized(_assertThisInitialized(e)));e._isWallCallback=e._isWallCallback.bind(_assertThisInitialized(_assertThisInitialized(e)));e._priorityWallCallback=e._priorityWallCallback.bind(_assertThisInitialized(_assertThisInitialized(e)));return e}_inherits(a,
b);_createClass(a,[{key:"create",value:function(a){this._rooms=[];this._corridors=[];this._map=this._fillMap(1);this._walls={};this._dug=0;var b=(this._width-2)*(this._height-2);this._firstRoom();var d=Date.now();do{var c=0;if(Date.now()-d>this._options.timeLimit)break;var h=this._findWall();if(!h)break;var f=h.split(",");h=parseInt(f[0]);f=parseInt(f[1]);var k=this._getDiggingDirection(h,f);if(k){var l=0;do if(l++,this._tryFeature(h,f,k[0],k[1])){this._removeSurroundingWalls(h,f);this._removeSurroundingWalls(h-
k[0],f-k[1]);break}while(l<this._featureAttempts);for(var m in this._walls)1<this._walls[m]&&c++}}while(this._dug/b<this._options.dugPercentage||c);this._addDoors();if(a)for(b=0;b<this._width;b++)for(d=0;d<this._height;d++)a(b,d,this._map[b][d]);this._walls={};this._map=[];return this}},{key:"_digCallback",value:function(a,b,c){0==c||2==c?(this._map[a][b]=0,this._dug++):this._walls[a+","+b]=1}},{key:"_isWallCallback",value:function(a,b){return 0>a||0>b||a>=this._width||b>=this._height?!1:1==this._map[a][b]}},
{key:"_canBeDugCallback",value:function(a,b){return 1>a||1>b||a+1>=this._width||b+1>=this._height?!1:1==this._map[a][b]}},{key:"_priorityWallCallback",value:function(a,b){this._walls[a+","+b]=2}},{key:"_firstRoom",value:function(){var a=L.createRandomCenter(Math.floor(this._width/2),Math.floor(this._height/2),this._options);this._rooms.push(a);a.create(this._digCallback)}},{key:"_findWall",value:function(){var a=[],b=[];for(c in this._walls)2==this._walls[c]?b.push(c):a.push(c);a=b.length?b:a;if(!a.length)return null;
var c=r.getItem(a.sort());delete this._walls[c];return c}},{key:"_tryFeature",value:function(a,b,c,h){var d=r.getWeightedValue(this._features);a=ba[d].createRandomAt(a,b,c,h,this._options);if(!a.isValid(this._isWallCallback,this._canBeDugCallback))return!1;a.create(this._digCallback);a instanceof L&&this._rooms.push(a);a instanceof R&&(a.createPriorityWalls(this._priorityWallCallback),this._corridors.push(a));return!0}},{key:"_removeSurroundingWalls",value:function(a,b){for(var d=y[4],c=0;c<d.length;c++){var e=
d[c],f=a+e[0],h=b+e[1];delete this._walls[f+","+h];f=a+2*e[0];h=b+2*e[1];delete this._walls[f+","+h]}}},{key:"_getDiggingDirection",value:function(a,b){if(0>=a||0>=b||a>=this._width-1||b>=this._height-1)return null;for(var d=null,c=y[4],e=0;e<c.length;e++){var f=c[e];if(!this._map[a+f[0]][b+f[1]]){if(d)return null;d=f}}return d?[-d[0],-d[1]]:null}},{key:"_addDoors",value:function(){function a(a,d){return 1==b[a][d]}for(var b=this._map,c=0;c<this._rooms.length;c++){var h=this._rooms[c];h.clearDoors();
h.addDoors(a)}}}]);return a}(v);w={Arena:w,Uniform:F,Cellular:D,Digger:v};v=function(){function b(a){_classCallCheck(this,b);this._scheduler=a;this._lock=1}_createClass(b,[{key:"start",value:function(){return this.unlock()}},{key:"lock",value:function(){this._lock++;return this}},{key:"unlock",value:function(){if(!this._lock)throw Error("Cannot unlock unlocked engine");for(this._lock--;!this._lock;){var a=this._scheduler.next();if(!a)return this.lock();(a=a.act())&&a.then&&(this.lock(),a.then(this.unlock.bind(this)))}return this}}]);
return b}();var M={black:[0,0,0],navy:[0,0,128],darkblue:[0,0,139],mediumblue:[0,0,205],blue:[0,0,255],darkgreen:[0,100,0],green:[0,128,0],teal:[0,128,128],darkcyan:[0,139,139],deepskyblue:[0,191,255],darkturquoise:[0,206,209],mediumspringgreen:[0,250,154],lime:[0,255,0],springgreen:[0,255,127],aqua:[0,255,255],cyan:[0,255,255],midnightblue:[25,25,112],dodgerblue:[30,144,255],forestgreen:[34,139,34],seagreen:[46,139,87],darkslategray:[47,79,79],darkslategrey:[47,79,79],limegreen:[50,205,50],mediumseagreen:[60,
179,113],turquoise:[64,224,208],royalblue:[65,105,225],steelblue:[70,130,180],darkslateblue:[72,61,139],mediumturquoise:[72,209,204],indigo:[75,0,130],darkolivegreen:[85,107,47],cadetblue:[95,158,160],cornflowerblue:[100,149,237],mediumaquamarine:[102,205,170],dimgray:[105,105,105],dimgrey:[105,105,105],slateblue:[106,90,205],olivedrab:[107,142,35],slategray:[112,128,144],slategrey:[112,128,144],lightslategray:[119,136,153],lightslategrey:[119,136,153],mediumslateblue:[123,104,238],lawngreen:[124,
252,0],chartreuse:[127,255,0],aquamarine:[127,255,212],maroon:[128,0,0],purple:[128,0,128],olive:[128,128,0],gray:[128,128,128],grey:[128,128,128],skyblue:[135,206,235],lightskyblue:[135,206,250],blueviolet:[138,43,226],darkred:[139,0,0],darkmagenta:[139,0,139],saddlebrown:[139,69,19],darkseagreen:[143,188,143],lightgreen:[144,238,144],mediumpurple:[147,112,216],darkviolet:[148,0,211],palegreen:[152,251,152],darkorchid:[153,50,204],yellowgreen:[154,205,50],sienna:[160,82,45],brown:[165,42,42],darkgray:[169,
169,169],darkgrey:[169,169,169],lightblue:[173,216,230],greenyellow:[173,255,47],paleturquoise:[175,238,238],lightsteelblue:[176,196,222],powderblue:[176,224,230],firebrick:[178,34,34],darkgoldenrod:[184,134,11],mediumorchid:[186,85,211],rosybrown:[188,143,143],darkkhaki:[189,183,107],silver:[192,192,192],mediumvioletred:[199,21,133],indianred:[205,92,92],peru:[205,133,63],chocolate:[210,105,30],tan:[210,180,140],lightgray:[211,211,211],lightgrey:[211,211,211],palevioletred:[216,112,147],thistle:[216,
191,216],orchid:[218,112,214],goldenrod:[218,165,32],crimson:[220,20,60],gainsboro:[220,220,220],plum:[221,160,221],burlywood:[222,184,135],lightcyan:[224,255,255],lavender:[230,230,250],darksalmon:[233,150,122],violet:[238,130,238],palegoldenrod:[238,232,170],lightcoral:[240,128,128],khaki:[240,230,140],aliceblue:[240,248,255],honeydew:[240,255,240],azure:[240,255,255],sandybrown:[244,164,96],wheat:[245,222,179],beige:[245,245,220],whitesmoke:[245,245,245],mintcream:[245,255,250],ghostwhite:[248,
248,255],salmon:[250,128,114],antiquewhite:[250,235,215],linen:[250,240,230],lightgoldenrodyellow:[250,250,210],oldlace:[253,245,230],red:[255,0,0],fuchsia:[255,0,255],magenta:[255,0,255],deeppink:[255,20,147],orangered:[255,69,0],tomato:[255,99,71],hotpink:[255,105,180],coral:[255,127,80],darkorange:[255,140,0],lightsalmon:[255,160,122],orange:[255,165,0],lightpink:[255,182,193],pink:[255,192,203],gold:[255,215,0],peachpuff:[255,218,185],navajowhite:[255,222,173],moccasin:[255,228,181],bisque:[255,
228,196],mistyrose:[255,228,225],blanchedalmond:[255,235,205],papayawhip:[255,239,213],lavenderblush:[255,240,245],seashell:[255,245,238],cornsilk:[255,248,220],lemonchiffon:[255,250,205],floralwhite:[255,250,240],snow:[255,250,250],yellow:[255,255,0],lightyellow:[255,255,224],ivory:[255,255,240],white:[255,255,255]};F=Object.freeze({fromString:I,add:function(b){for(var a=b.slice(),d=arguments.length,c=Array(1<d?d-1:0),g=1;g<d;g++)c[g-1]=arguments[g];for(d=0;3>d;d++)for(g=0;g<c.length;g++)a[d]+=c[g][d];
return a},add_:S,multiply:function(b){for(var a=b.slice(),d=arguments.length,c=Array(1<d?d-1:0),g=1;g<d;g++)c[g-1]=arguments[g];for(d=0;3>d;d++){for(g=0;g<c.length;g++)a[d]*=c[g][d]/255;a[d]=Math.round(a[d])}return a},multiply_:function(b){for(var a=arguments.length,d=Array(1<a?a-1:0),c=1;c<a;c++)d[c-1]=arguments[c];for(a=0;3>a;a++){for(c=0;c<d.length;c++)b[a]*=d[c][a]/255;b[a]=Math.round(b[a])}return b},interpolate:T,lerp:T,interpolateHSL:U,lerpHSL:U,randomize:function(b,a){a instanceof Array||(a=
Math.round(r.getNormal(0,a)));b=b.slice();for(var d=0;3>d;d++)b[d]+=a instanceof Array?Math.round(r.getNormal(0,a[d])):a;return b},rgb2hsl:N,hsl2rgb:V,toRGB:function(b){b=b.map(function(a){return m(a,0,255)});return"rgb(".concat(b.join(","),")")},toHex:function(b){b=b.map(function(a){return m(a,0,255).toString(16).padStart(2,"0")});return"#".concat(b.join(""))}});D=function(){function b(a){var d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,b);this._reflectivityCallback=
a;this._options={};d=Object.assign({passes:1,emissionThreshold:100,range:10},d);this._lights={};this._reflectivityCache={};this._fovCache={};this.setOptions(d)}_createClass(b,[{key:"setOptions",value:function(a){Object.assign(this._options,a);a&&a.range&&this.reset();return this}},{key:"setFOV",value:function(a){this._fov=a;this._fovCache={};return this}},{key:"setLight",value:function(a,b,c){a=a+","+b;c?this._lights[a]="string"==typeof c?I(c):c:delete this._lights[a];return this}},{key:"clearLights",
value:function(){this._lights={}}},{key:"reset",value:function(){this._reflectivityCache={};this._fovCache={};return this}},{key:"compute",value:function(a){var b={},c={},g={},h;for(h in this._lights){var n=this._lights[h];c[h]=[0,0,0];S(c[h],n)}for(h=0;h<this._options.passes;h++)this._emitLight(c,g,b),h+1!=this._options.passes&&(c=this._computeEmitters(g,b));for(var f in g)c=f.split(","),b=parseInt(c[0]),c=parseInt(c[1]),a(b,c,g[f]);return this}},{key:"_emitLight",value:function(a,b,c){for(var d in a){var e=
d.split(","),h=parseInt(e[0]);e=parseInt(e[1]);this._emitLightFromCell(h,e,a[d],b);c[d]=1}return this}},{key:"_computeEmitters",value:function(a,b){var d={},c;for(c in a)if(!(c in b)){var h=a[c];if(c in this._reflectivityCache)var n=this._reflectivityCache[c];else{var f=c.split(",");n=parseInt(f[0]);f=parseInt(f[1]);n=this._reflectivityCallback(n,f);this._reflectivityCache[c]=n}if(0!=n){f=[0,0,0];for(var k=0,l=0;3>l;l++){var m=Math.round(h[l]*n);f[l]=m;k+=m}k>this._options.emissionThreshold&&(d[c]=
f)}}return d}},{key:"_emitLightFromCell",value:function(a,b,c,g){var d=a+","+b;a=d in this._fovCache?this._fovCache[d]:this._updateFOV(a,b);for(var e in a){b=a[e];e in g?d=g[e]:(d=[0,0,0],g[e]=d);for(var f=0;3>f;f++)d[f]+=Math.round(c[f]*b)}return this}},{key:"_updateFOV",value:function(a,b){var c={};this._fovCache[a+","+b]=c;var d=this._options.range;this._fov.compute(a,b,d,function(a,b,e,g){e=g*(1-e/d);0!=e&&(c[a+","+b]=e)}.bind(this));return c}}]);return b}();c.Util=Y;c.Color=F;c.Text=H;c.RNG=
r;c.Display=K;c.StringGenerator=J;c.EventQueue=W;c.Scheduler=C;c.FOV=z;c.Map=w;c.Engine=v;c.Lighting=D;c.DEFAULT_WIDTH=80;c.DEFAULT_HEIGHT=25;c.DIRS=y;c.KEYS={VK_CANCEL:3,VK_HELP:6,VK_BACK_SPACE:8,VK_TAB:9,VK_CLEAR:12,VK_RETURN:13,VK_ENTER:14,VK_SHIFT:16,VK_CONTROL:17,VK_ALT:18,VK_PAUSE:19,VK_CAPS_LOCK:20,VK_ESCAPE:27,VK_SPACE:32,VK_PAGE_UP:33,VK_PAGE_DOWN:34,VK_END:35,VK_HOME:36,VK_LEFT:37,VK_UP:38,VK_RIGHT:39,VK_DOWN:40,VK_PRINTSCREEN:44,VK_INSERT:45,VK_DELETE:46,VK_0:48,VK_1:49,VK_2:50,VK_3:51,
VK_4:52,VK_5:53,VK_6:54,VK_7:55,VK_8:56,VK_9:57,VK_COLON:58,VK_SEMICOLON:59,VK_LESS_THAN:60,VK_EQUALS:61,VK_GREATER_THAN:62,VK_QUESTION_MARK:63,VK_AT:64,VK_A:65,VK_B:66,VK_C:67,VK_D:68,VK_E:69,VK_F:70,VK_G:71,VK_H:72,VK_I:73,VK_J:74,VK_K:75,VK_L:76,VK_M:77,VK_N:78,VK_O:79,VK_P:80,VK_Q:81,VK_R:82,VK_S:83,VK_T:84,VK_U:85,VK_V:86,VK_W:87,VK_X:88,VK_Y:89,VK_Z:90,VK_CONTEXT_MENU:93,VK_NUMPAD0:96,VK_NUMPAD1:97,VK_NUMPAD2:98,VK_NUMPAD3:99,VK_NUMPAD4:100,VK_NUMPAD5:101,VK_NUMPAD6:102,VK_NUMPAD7:103,VK_NUMPAD8:104,
VK_NUMPAD9:105,VK_MULTIPLY:106,VK_ADD:107,VK_SEPARATOR:108,VK_SUBTRACT:109,VK_DECIMAL:110,VK_DIVIDE:111,VK_F1:112,VK_F2:113,VK_F3:114,VK_F4:115,VK_F5:116,VK_F6:117,VK_F7:118,VK_F8:119,VK_F9:120,VK_F10:121,VK_F11:122,VK_F12:123,VK_F13:124,VK_F14:125,VK_F15:126,VK_F16:127,VK_F17:128,VK_F18:129,VK_F19:130,VK_F20:131,VK_F21:132,VK_F22:133,VK_F23:134,VK_F24:135,VK_NUM_LOCK:144,VK_SCROLL_LOCK:145,VK_CIRCUMFLEX:160,VK_EXCLAMATION:161,VK_DOUBLE_QUOTE:162,VK_HASH:163,VK_DOLLAR:164,VK_PERCENT:165,VK_AMPERSAND:166,
VK_UNDERSCORE:167,VK_OPEN_PAREN:168,VK_CLOSE_PAREN:169,VK_ASTERISK:170,VK_PLUS:171,VK_PIPE:172,VK_HYPHEN_MINUS:173,VK_OPEN_CURLY_BRACKET:174,VK_CLOSE_CURLY_BRACKET:175,VK_TILDE:176,VK_COMMA:188,VK_PERIOD:190,VK_SLASH:191,VK_BACK_QUOTE:192,VK_OPEN_BRACKET:219,VK_BACK_SLASH:220,VK_CLOSE_BRACKET:221,VK_QUOTE:222,VK_META:224,VK_ALTGR:225,VK_WIN:91,VK_KANA:21,VK_HANGUL:21,VK_EISU:22,VK_JUNJA:23,VK_FINAL:24,VK_HANJA:25,VK_KANJI:25,VK_CONVERT:28,VK_NONCONVERT:29,VK_ACCEPT:30,VK_MODECHANGE:31,VK_SELECT:41,
VK_PRINT:42,VK_EXECUTE:43,VK_SLEEP:95};return c}({});
